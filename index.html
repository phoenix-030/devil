<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>For My Best Friend ‚ù§Ô∏è</title>

  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600&display=swap" rel="stylesheet">

  <style>
    *{margin:0;padding:0;box-sizing:border-box;font-family:'Poppins',sans-serif}

    body{
      height:100vh;
      display:flex;
      align-items:center;
      justify-content:center;
      overflow:hidden;
      background:linear-gradient(-45deg,#ff758c,#ff7eb3,#fad0c4,#ff9a9e);
      background-size:400% 400%;
      animation:gradientFlow 12s ease infinite;
      position:relative;
    }

    @keyframes gradientFlow{
      0%{background-position:0% 50%}
      50%{background-position:100% 50%}
      100%{background-position:0% 50%}
    }

    .shake{animation:shake .25s}
    @keyframes shake{
      0%{transform:translate(2px,1px)}
      25%{transform:translate(-2px,-1px)}
      50%{transform:translate(2px,-1px)}
      75%{transform:translate(-2px,1px)}
      100%{transform:translate(0,0)}
    }

    .heart{
      position:absolute;
      bottom:-20px;
      pointer-events:none;
      animation:floatUp linear infinite;
    }
    @keyframes floatUp{to{transform:translateY(-110vh);opacity:0}}

    .container{
      background:rgba(255,255,255,0.2);
      backdrop-filter:blur(15px);
      padding:40px 30px;
      border-radius:25px;
      text-align:center;
      box-shadow:0 25px 60px rgba(0,0,0,0.25);
      width:90%;
      max-width:420px;
      color:white;
      animation:fadeIn 1.2s ease;
      position:relative;
      z-index:2;
    }

    .name-input{
      width:100%;
      padding:10px;
      border-radius:20px;
      border:none;
      margin-bottom:20px;
      text-align:center;
      outline:none;
    }

    .buttons{
      display:flex;
      justify-content:center;
      gap:15px;
      margin-bottom:10px;
      flex-wrap:wrap;
    }

    button{
      padding:12px 26px;
      border-radius:30px;
      border:none;
      cursor:pointer;
      font-size:1rem;
      transition:.25s;
    }

    #openBtn{
      background:white;
      color:#ff4f81;
      font-weight:600;
      box-shadow:0 10px 25px rgba(0,0,0,.2);
    }

    #closeBtn{
      background:rgba(255,255,255,0.3);
      color:white;
      border:1px solid rgba(255,255,255,0.5);
    }

    .countdown{font-size:2rem;font-weight:600;height:35px}

    .quote-box{
      position:relative;
      margin-top:20px;
      transform:scale(.8);
      opacity:0;
      transition:.5s ease;
      pointer-events:none;
      max-width:100%;
    }
    .quote-box.show{transform:scale(1);opacity:1}

    /* FIX: removed width:0 which hid the text */
    .quote{
      font-size:1.2rem;
      margin-bottom:12px;
      border-right:2px solid white;
      display:inline-block;
      max-width:100%;
      white-space:normal;
      word-wrap:break-word;
      animation:blink .8s infinite;
    }
    @keyframes blink{50%{border-color:transparent}}

    .burst-heart,.confetti,.mini-letter{
      position:absolute;
      pointer-events:none;
      animation:burst 900ms ease forwards;
    }
    @keyframes burst{to{transform:translate(var(--x),var(--y)) scale(1.6);opacity:0}}

    @media(max-width:480px){
      .quote{border-right:none}
      button{width:100%}
    }
  </style>
</head>
<body>

<audio id="music" loop preload="auto" src="https://cdn.pixabay.com/download/audio/2022/03/15/audio_8c6e4d0f4d.mp3?filename=romantic-background-112191.mp3"></audio>
<audio id="blastSound" src="https://cdn.pixabay.com/download/audio/2021/08/04/audio_cdf0cfd6d1.mp3?filename=pop-94319.mp3"></audio>

<div class="container" id="container">
  <h1>Hey My Friend üíï</h1>
  <p>Enter your name for a surprise ‚ú®</p>

  <input class="name-input" id="friendInput" placeholder="Type your  name... devil" />

  <div class="buttons">
    <button id="openBtn">Open üíå</button>
    <button id="closeBtn">Close üôÇ</button>
  </div>

  <div class="countdown" id="countdown"></div>

  <div class="quote-box" id="quoteBox">
    <div class="quote" id="quote"></div>
    <div id="friendName">‚Äî Devil ü§ç-</div>
  </div>
</div>

<script>
const openBtn=document.getElementById("openBtn");
const closeBtn=document.getElementById("closeBtn");
const quoteBox=document.getElementById("quoteBox");
const quote=document.getElementById("quote");
const music=document.getElementById("music");
const blastSound=document.getElementById("blastSound");
const countdownEl=document.getElementById("countdown");
const friendInput=document.getElementById("friendInput");
const friendName=document.getElementById("friendName");
const container=document.getElementById("container");

let lastIndex=-1;
let opened=false;

function createHeart(){
  const heart=document.createElement("div");
  heart.className="heart";
  heart.innerHTML="‚ù§Ô∏è";
  heart.style.left=Math.random()*100+"vw";
  heart.style.animationDuration=(3+Math.random()*5)+"s";
  heart.style.fontSize=(12+Math.random()*20)+"px";
  document.body.appendChild(heart);
  setTimeout(()=>heart.remove(),8000);
}
setInterval(createHeart,300);

closeBtn.addEventListener("mouseenter",()=>{
  if(opened) return;
  closeBtn.style.transform=`translate(${Math.random()*150}px,${Math.random()*60}px)`;
});

const quotes=[
"Some people come into your life and quietly become your favorite hello ü§ç",
"With you, even ordinary moments feel a little more special ‚ú®",
"Friendship like yours is rare ‚Äî comfortable, constant, and warm üå∏",
"Out of everyone I know, you understand me without needing words üí´",
"Life feels lighter when you‚Äôre around üòä",
"If I had to choose a person to share my random thoughts with forever, it would be you üå∑",
"You‚Äôre the kind of friend people wish they had üíï",
"Some bonds don‚Äôt need labels ‚Äî they just feel right üåô",
"No matter where life goes, I hope it always keeps you close üíñ",
"There is something beautifully effortless about us ‚ù§Ô∏è"
];

function getRandomQuote(){
  let index;
  do{index=Math.floor(Math.random()*quotes.length);}while(index===lastIndex);
  lastIndex=index;
  return quotes[index];
}

/* FIXED: removed stray brace that previously caused syntax error */
function typeText(text){
  quote.textContent="";
  let i=0;

  function typing(){
    if(i<text.length){
      quote.textContent+=text.charAt(i);
      i++;
      setTimeout(typing,30);
    }
  }

  typing();
}

function explosionFX(){
  blastSound.currentTime=0;
  blastSound.play();

  container.classList.add("shake");
  setTimeout(()=>container.classList.remove("shake"),250);

  for(let i=0;i<20;i++){
    const el=document.createElement("div");
    el.className=Math.random()>.5?"burst-heart":"confetti";
    el.innerHTML=Math.random()>.5?"üíñ":"üéÜ";

    const angle=Math.random()*360;
    const dist=90+Math.random()*40;

    el.style.left="50%";
    el.style.top="50%";
    el.style.setProperty("--x",Math.cos(angle)*dist+"px");
    el.style.setProperty("--y",Math.sin(angle)*dist+"px");

    document.body.appendChild(el);
    setTimeout(()=>el.remove(),900);
  }

  for(let i=0;i<6;i++){
    const note=document.createElement("div");
    note.className="mini-letter";
    note.innerHTML="üíå";

    const angle=Math.random()*360;
    const dist=100+Math.random()*60;

    note.style.left="50%";
    note.style.top="50%";
    note.style.setProperty("--x",Math.cos(angle)*dist+"px");
    note.style.setProperty("--y",Math.sin(angle)*dist+"px");

    document.body.appendChild(note);
    setTimeout(()=>note.remove(),900);
  }
}

function startCountdown(cb){
  let count=3;
  countdownEl.textContent=count;

  const interval=setInterval(()=>{
    count--;
    if(count>0){
      countdownEl.textContent=count;
    }else{
      clearInterval(interval);
      countdownEl.textContent="üí•";
      setTimeout(()=>{
        countdownEl.textContent="";
        cb();
      },400);
    }
  },700);
}

openBtn.addEventListener("click",()=>{
  opened=true;

  const name=friendInput.value.trim()||"My Best Friend";
  friendName.textContent=`‚Äî For ${name} ‚ù§Ô∏è`;

  startCountdown(()=>{
    quoteBox.classList.add("show");
    typeText(getRandomQuote());
    explosionFX();
  });

  music.currentTime=0;
  music.volume=0.6;
  const playPromise = music.play();
  if(playPromise !== undefined){
    playPromise.catch(()=>{
      console.warn("Background music could not autoplay. User interaction may be required.");
    });
  }
});

closeBtn.addEventListener("click",()=>{
  opened=false;
  quoteBox.classList.remove("show");
  closeBtn.style.transform="translate(0,0)";
  countdownEl.textContent="";
  quote.textContent="";
  music.pause();
});

/* TEST CASES */
console.assert(quotes.length>=10,"Need at least 10 quotes");
console.assert(typeof typeText === 'function',"typeText must exist");
console.assert(document.getElementById('openBtn'),"Open button missing");
console.assert(document.getElementById('closeBtn'),"Close button missing");
console.assert(blastSound,"Blast sound missing");
</script>
</body>
</html>
